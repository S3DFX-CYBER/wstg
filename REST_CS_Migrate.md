# REST असेसमेंट चीट शीट

## RESTful वेब सर्विसेज के बारे में

वेब सर्विसेज वेब टेक्नोलॉजी का एक इम्प्लीमेंटेशन है जिसका उपयोग मशीन से मशीन संचार के लिए किया जाता है। इस प्रकार इनका उपयोग इंटर एप्लिकेशन कम्युनिकेशन, वेब 2.0 और मैशअप्स में, तथा डेस्कटॉप और मोबाइल एप्लिकेशन द्वारा सर्वर को कॉल करने के लिए किया जाता है।

RESTful वेब सर्विसेज (जिन्हें अक्सर सिर्फ REST कहा जाता है) वेब सर्विसेज का एक हल्का वेरिएंट है जो RESTful डिजाइन पैटर्न पर आधारित है। व्यावहारिक रूप में RESTful वेब सर्विसेज HTTP रिक्वेस्ट का उपयोग करती हैं जो SOAP जैसी अन्य वेब सर्विस टेक्नोलॉजी की तुलना में रेगुलर HTTP कॉल के समान होती हैं।

## RESTful वेब सर्विसेज की प्रमुख विशेषताएं

- **HTTP methods** (`GET`, `POST`, `PUT` और `DELETE`) का उपयोग रिक्वेस्ट किए गए ऑपरेशन के लिए प्राथमिक क्रिया के रूप में किया जाता है।

- **नॉन-स्टैंडर्ड पैरामीटर स्पेसिफिकेशन:**
    - URL के हिस्से के रूप में
    - Headers में

- **JSON या XML का उपयोग करके स्ट्रक्चर्ड पैरामीटर और रिस्पांस** - ये मशीन-उपयोगी जानकारी संप्रेषित करने के लिए आवश्यक हैं।

- **कस्टम ऑथेंटिकेशन और सेशन मैनेजमेंट**, अक्सर कस्टम सिक्योरिटी टोकन का उपयोग करते हुए: यह आवश्यक है क्योंकि मशीन से मशीन संचार लॉगिन सीक्वेंस की अनुमति नहीं देता।

- **फॉर्मल डॉक्युमेंटेशन का अभाव** - [WADL नामक RESTful वेब सर्विसेज का वर्णन करने के लिए प्रस्तावित स्टैंडर्ड](https://www.w3.org/Submission/wadl/) Sun Microsystems द्वारा सबमिट किया गया था लेकिन इसे आधिकारिक तौर पर कभी अपनाया नहीं गया।

## RESTful वेब सर्विसेज की सिक्योरिटी टेस्टिंग की चुनौतियां

- **एप्लिकेशन का निरीक्षण अटैक सरफेस को प्रकट नहीं करता**, यानी RESTful वेब सर्विस द्वारा उपयोग किए जाने वाले URLs और पैरामीटर स्ट्रक्चर। कारण हैं:
    - कोई भी एप्लिकेशन सर्विस द्वारा उपलब्ध सभी फंक्शन और पैरामीटर का उपयोग नहीं करता
    - जो उपयोग किए जाते हैं वे अक्सर क्लाइंट-साइड कोड द्वारा डायनामिकली एक्टिवेट होते हैं न कि पेज में लिंक के रूप में
    - क्लाइंट एप्लिकेशन अक्सर वेब एप्लिकेशन नहीं होता और एक्टिवेटिंग लिंक या प्रासंगिक कोड के निरीक्षण की अनुमति नहीं देता

- **पैरामीटर नॉन-स्टैंडर्ड होते हैं** जिससे यह निर्धारित करना मुश्किल हो जाता है कि क्या URL का हिस्सा है या कॉन्स्टेंट हेडर है और क्या [fuzzing](https://owasp.org/www-community/Fuzzing) के लायक पैरामीटर है।

- **मशीन इंटरफ़ेस के रूप में** उपयोग किए जाने वाले पैरामीटर की संख्या बहुत बड़ी हो सकती है, उदाहरण के लिए एक JSON स्ट्रक्चर में दर्जनों पैरामीटर शामिल हो सकते हैं। प्रत्येक को [fuzzing](https://owasp.org/www-community/Fuzzing) करने से टेस्टिंग के लिए आवश्यक समय काफी बढ़ जाता है।

- **कस्टम ऑथेंटिकेशन मैकेनिज्म** को रिवर्स इंजीनियरिंग की आवश्यकता होती है और लोकप्रिय टूल्स को बेकार बना देते हैं क्योंकि वे लॉगिन सेशन को ट्रैक नहीं कर सकते।

## RESTful वेब सर्विस का पेनटेस्ट कैसे करें

### 1. डॉक्युमेंटेशन के माध्यम से अटैक सरफेस निर्धारित करें

RESTful पेन टेस्टिंग बेहतर हो सकती है यदि कुछ स्तर की व्हाइट बॉक्स टेस्टिंग की अनुमति हो और आप सर्विस के बारे में जानकारी प्राप्त कर सकें।

**देखने योग्य जानकारी:**

- **फॉर्मल सर्विस डिस्क्रिप्शन** - जबकि SOAP जैसी अन्य वेब सर्विसेज के लिए आमतौर पर WSDL में फॉर्मल डिस्क्रिप्शन उपलब्ध होता है, REST के लिए यह शायद ही कभी होता है। फिर भी, WSDL 2.0 या WADL REST का वर्णन कर सकते हैं और कभी-कभी उपयोग किए जाते हैं।

- **डेवलपर गाइड** - सर्विस उपयोग के लिए डेवलपर गाइड कम विस्तृत हो सकती है लेकिन आमतौर पर मिल जाती है, और इसे *ब्लैक बॉक्स* भी माना जा सकता है।

- **एप्लिकेशन सोर्स या कॉन्फ़िगरेशन** - कई फ्रेमवर्क में, dotNet सहित, REST सर्विस डेफिनिशन आसानी से कोड के बजाय कॉन्फ़िगरेशन फ़ाइलों से प्राप्त की जा सकती है।

### 2. Proxy का उपयोग करके पूर्ण रिक्वेस्ट एकत्र करें

[Proxy](https://www.zaproxy.org/) का उपयोग करके पूर्ण रिक्वेस्ट एकत्र करना REST आधारित एप्लिकेशन के लिए अधिक महत्वपूर्ण है क्योंकि एप्लिकेशन UI वास्तविक अटैक सरफेस पर संकेत नहीं दे सकता है।

**नोट:** Proxy को पूर्ण रिक्वेस्ट एकत्र करने में सक्षम होना चाहिए न कि केवल URLs, क्योंकि REST सर्विसेज केवल GET पैरामीटर से अधिक का उपयोग करती हैं।

### 3. अटैक सरफेस निर्धारित करने के लिए एकत्रित रिक्वेस्ट का विश्लेषण करें

**नॉन-स्टैंडर्ड पैरामीटर की तलाश करें:**

- **असामान्य HTTP headers देखें** - ये कई बार header-based पैरामीटर होंगे।

- **निर्धारित करें कि क्या URL सेगमेंट में URLs में दोहराया जाने वाला पैटर्न है**। ऐसे पैटर्न में एक तारीख, एक संख्या या ID जैसी स्ट्रिंग शामिल हो सकती है और यह संकेत करती है कि URL सेगमेंट एक URL एम्बेडेड पैरामीटर है।
    - **उदाहरण:** `https://server/srv/2013-10-21/use.php`

- **स्ट्रक्चर्ड पैरामीटर वैल्यू देखें** - ये JSON, XML या नॉन-स्टैंडर्ड स्ट्रक्चर हो सकते हैं।

- **यदि URL का अंतिम तत्व में एक्सटेंशन नहीं है, तो यह एक पैरामीटर हो सकता है**। यह विशेष रूप से सच है यदि एप्लिकेशन टेक्नोलॉजी सामान्य रूप से एक्सटेंशन का उपयोग करती है या यदि पिछले सेगमेंट में एक्सटेंशन है।
    - **उदाहरण:** `https://server/svc/Grid.asmx/GetRelatedListItems`

- **अत्यधिक भिन्न URL सेगमेंट देखें** - एक सिंगल URL सेगमेंट जिसमें कई वैल्यू हैं, वह पैरामीटर हो सकता है न कि फिजिकल डायरेक्टरी।
    - **उदाहरण:** यदि URL `https://server/src/XXXX/page` में `XXXX` के लिए सैकड़ों वैल्यू के साथ दोहराव होता है, तो संभावना है कि `XXXX` एक पैरामीटर है।

### 4. नॉन-स्टैंडर्ड पैरामीटर वेरिफाई करें

कुछ मामलों में (लेकिन सभी में नहीं), एक URL सेगमेंट की वैल्यू को सेट करना जिसे पैरामीटर होने का संदेह है, एक अमान्य होने की उम्मीद की जाने वाली वैल्यू में, यह निर्धारित करने में मदद कर सकता है कि यह एक पाथ एलीमेंट है या पैरामीटर।

- यदि पाथ एलीमेंट है, तो वेब सर्वर *404* मैसेज लौटाएगा
- जबकि पैरामीटर की अमान्य वैल्यू के लिए उत्तर एप्लिकेशन लेवल मैसेज होगा

### 5. Fuzzing को ऑप्टिमाइज़ करने के लिए एकत्रित रिक्वेस्ट का विश्लेषण करें

संभावित पैरामीटर की पहचान करने के बाद, प्रत्येक के लिए एकत्रित वैल्यू का विश्लेषण करें:

- **वैध बनाम अमान्य वैल्यू** निर्धारित करें, ताकि [fuzzing](https://owasp.org/www-community/Fuzzing) मार्जिनल अमान्य वैल्यू पर फोकस कर सके।
    - **उदाहरण:** हमेशा पॉजिटिव इंटीजर पाई गई वैल्यू के लिए *0* भेजना।

- **सीक्वेंस** जो वर्तमान यूजर को आवंटित रेंज से परे fuzzing की अनुमति दें।

**अंत में**, जब [fuzzing](https://owasp.org/www-community/Fuzzing) करें, तो उपयोग किए गए ऑथेंटिकेशन मैकेनिज्म को एमुलेट करना न भूलें।

## संबंधित संसाधन

- [REST Security Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/REST_Security_Cheat_Sheet.html) - इस चीट शीट का दूसरा पक्ष
- [RESTful services, web security blind spot](https://www.youtube.com/watch?v=pWq4qGLAZHI) - एक वीडियो प्रेजेंटेशन जो इस चीट शीट के अधिकांश विषयों को विस्तार से बताता है
